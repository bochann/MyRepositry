  
  	//仮で現在id設定（本来はUUIDで乱数を取得）    private String mUserId ="aaaaaa";    //ポイント用変数    int point = 0;    // POST通信を実行（AsyncTaskによる非同期処理を使うバージョン）    //チェック通信    private void exec_post1() {        // 非同期タスクを定義        HttpPostTask task = new HttpPostTask(                this,                "http://orange.lolipop.jp/index.php",                // タスク完了時に呼ばれるUIのハンドラ                new HttpPostHandler(){                    @Override                    public void onPostCompleted(String response) {                        // 受信結果をUIに表示                        Toast.makeText(                                getApplicationContext(),                                response,                                Toast.LENGTH_LONG                        ).show();                        //achiveID用変数                        String achiveId = "";                        ////////responseを解析///////                        //JSONを解析                        try {                            //JSONオブジェクトにJSONをセット                            JSONObject rootObject = new JSONObject(response);                            //res_codeを取り出す                            String resCode = rootObject.getString("res_code");                            /**                             * レスポンスコードが0であればacheve_idとpointを取得する                             * レスポンスコードが1であればacheve_idとpointを取得しない                             */                            if(resCode.equals("0")){                                //JSONオブジェクトからacheve_IDを取り出す                                JSONArray eventArray = rootObject.getJSONArray("achieve_id");                                //JSONオブジェクトからPointをとりだす　                                JSONArray pointArray = rootObject.getJSONArray("point");                                for (int i = 0; i < eventArray.length(); i++) {                                    //achiveIDを取り出す                                    achiveId=eventArray.getString(i);                                    Log.d("achive_id", achiveId);                                    //ポイントを取り出す                                    point=pointArray.getInt(i);                                    Log.d("point",String.valueOf(point));                                    //achiveID,point保存                                    mSaveDB.addNewRewardRecordByAchieveId(achiveId,point);                                }                                /**                                 * 完了の通信開始                                 */                                exec_post2(achiveId);                            }                            //エラー処理                        }catch (JSONException e) {                            e.printStackTrace();                        }                    }                    @Override                    public void onPostFailed(String response) {                        Toast.makeText(                                getApplicationContext(),                                "エラーが発生しました。636",                                Toast.LENGTH_LONG                        ).show();                    }                }        );;        //リクエストコードをセット        task.addPostParam( "req_code", "1" );        //ユーザーIDをセット        task.addPostParam( "identifier", mUserId);        // タスクを開始        task.execute();    }    //完了通信    private void exec_post2(String achiveId) {        ArrayList achieveIds = new ArrayList();        achieveIds.add(achiveId);        achieveIds.add("12345");        if (achieveIds.size() > 0){            // 非同期タスクを定義            HttpPostTask task = new HttpPostTask(                    this,                    "http://orange.lolipop.jp/index.php",                    // タスク完了時に呼ばれるUIのハンドラ                    new HttpPostHandler(){                        @Override                        public void onPostCompleted(String response) {                            // 受信結果をUIに表示                            Toast.makeText(                                    getApplicationContext(),                                    response,                                    Toast.LENGTH_LONG                            ).show();                            //レコード取得用arraylist作成                            ArrayList<ArrayList> points = mSaveDB.getAllRewardRecord();                            //　achiveID取得                            String mUserAchiveID = (String)points.get(0).get(1);                            // achiveIDでポイント取得                            ArrayList userPointList = mSaveDB.getRewardRecodeByAchieveId(mUserAchiveID);                            //ポイント取得                            Integer userPoint = (Integer)userPointList.get(2);                            //ポイントがあればダイアログ表示                            if(0<userPoint.intValue()){                                CustomDialogFragment cdf = new CustomDialogFragment(MainManu.this);                                cdf.rewardDialog();                                cdf.show();                                /**                                 * ダイヤプレゼント処理                                 * プレゼントに反映                                 */                                mSaveDB.addNewPresentByType(1,userPoint.intValue(),1);                            }                            //achiveIDがあれば削除                            if(mSaveDB.isRewardRecordWithAchieveId(mUserAchiveID) == true){                                 //データ削除                                 mSaveDB.deleteRewardRecodeByAchieveId(mUserAchiveID);                            }                        }                        @Override                        public void onPostFailed(String response) {                            // 受信結果をUIに表示                            Toast.makeText(                                    getApplicationContext(),                                    response,                                    Toast.LENGTH_LONG                            ).show();                        }                    }            );            //Json作成            JSONArray jAchieves = new JSONArray(achieveIds);            //レスポンスコードセット            task.addPostParam( "req_code", "2" );            //ユーザーID            task.addPostParam( "identifier", mUserId );            //成果ID(JSON形式)            task.addPostParam( "achieve_id", jAchieves.toString());            // タスクを開始            task.execute();        }    }